# SpecUNet Code

This repository contains the MATLAB code and sample data used in the manuscript submitted to **Nature Communications**. The manuscript introduces **SpecUNet**, a specialized U-Netâ€“based neural network for Spectroscopic Single Molecule Localization Microscopy (sSMLM) Imaging Denoising.

## Table of Contents
- [Overview](#overview)
- [Repository Contents](#repository-contents)
- [Getting Started](#getting-started)
- [Usage](#usage)
  - [1. DataSimulation](#1-datasimulation)
  - [2. Network Training](#2-network-training)
  - [3. Evaluation](#3-evaluation)
  - [4. Additional Scripts](#4-additional-scripts)
- [Data](#data)
- [Citation](#citation)
- [License](#license)

## Overview
This code base demonstrates how to:
1. Simulate Monte-Carlo (MC) Simulation training data for **SpecUNet**.
2. Train the **SpecUNet** model in MATLAB using the provided sample data.
3. Evaluate the trained model on independent test data.

## Repository Contents
- **DataSimulation.m**  
  Script for simulating and preprocessing data before training.
  **Note**: If generating training data, please set `Numspectra = 100,000` to ensure consistency with model expectations.

- **Networktraining.m**  
  Main script for training the SpecUNet model.
  **Note**: If training, please use a dataset generated by `DataSimulation.m` with a data size of 100,000 for optimal training results. 

- **Evaluation_IndependentTestingData.m**  
  Script for evaluating the trained model on independent test data.  

- **Sample_TrainingData_10000.mat**  
  Example training data file used in the manuscript with only 10,000 data points included.  
  **Note**: If training, please use a dataset generated by `DataSimulation.m` with a data size of 100,000 for optimal training results.

- **TestingData.mat**  
  Example testing data file used for final evaluation.  

- **net.mat**  
  A pre-trained network (example network) that we used in this manuscript.

- **setNetworkMaxpooling.m**  
  Function of creating network architecture.  

- **LICENSE**  
  The license under which this repository is shared.  

- **README.md**  
  This file.

## Getting Started
1. **MATLAB Version**  
   The code was developed and tested in MATLAB R2024a. Make sure you have the required toolboxes:
   - Deep Learning Toolbox
   - (Optionally) Parallel Computing Toolbox if you want to run on a GPU

2. **Cloning the Repository**  
   ```bash
   git clone https://github.com/your-username/SpecUNet.git
   cd SpecUNet

3. **Add the Folder to MATLAB Path**
In MATLAB, navigate to the cloned folder and add it to your path:
  ```bash
  addpath(genpath('SpecUNet'));
  ```

## Acknowledgments

We used the following papers for our implementation, cited using BibTeX:

**U-Net: Convolutional Networks for Biomedical Image Segmentation**

```
@inproceedings{ronneberger2015u,
  title={U-net: Convolutional networks for biomedical image segmentation},
  author={Ronneberger, Olaf and Fischer, Philipp and Brox, Thomas},
  booktitle={Medical image computing and computer-assisted intervention--MICCAI 2015: 18th international conference, Munich, Germany, October 5-9, 2015, proceedings, part III 18},
  pages={234--241},
  year={2015},
  organization={Springer}
}
```
