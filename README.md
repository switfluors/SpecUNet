# SpecUNet Code

This repository contains the MATLAB code and sample data used in the manuscript submitted to **Nature Communications**. The manuscript introduces **SpecUNet**, a specialized U-Netâ€“based neural network for Spectroscopic Single Molecule Localization Microscopy (sSMLM) Imaging Denoising.

## Table of Contents
- [Overview](#overview)
- [Repository Contents and Usage](#repository-contents)
- [MATLAB Version and Tool box](#MATLAB-Version-and-Tool-box)
- [Citation](#citation)

## Overview
This code base demonstrates how to:
1. Simulate Monte-Carlo (MC) Simulation training data for **SpecUNet**.
2. Train the **SpecUNet** model in MATLAB using the provided sample data.
3. Evaluate the trained model on independent test data.

## Repository Contents and Usage
- **DataSimulation.m**  
  Script for simulating and preprocessing data before training.
  **Note**: If generating training data, please set `Numspectra = 100,000` to ensure consistency with model expectations.

- **Networktraining.m**  
  Main script for training the SpecUNet model.
  **Note**: If training, please use a dataset generated by `DataSimulation.m` with a data size of 100,000 for optimal training results. 

- **Evaluation_IndependentTestingData.m**  
  Script for evaluating the trained model on independent test data.  

- **Sample_TrainingData_10000.mat**  
  Example training data file used in the manuscript with only 10,000 data points included.  
  **Note**: If training, please use a dataset generated by `DataSimulation.m` with a data size of 100,000 for optimal training results.

- **TestingData.mat**  
  Example testing data file used for final evaluation.  

- **net.mat**  
  A pre-trained network (example network) that we used in this manuscript.

- **setNetworkMaxpooling.m**  
  Function of creating network architecture.  

- **LICENSE**  
  The license under which this repository is shared.  

- **README.md**  
  This file.

 ## MATLAB Version and Tool box
   The code was developed and tested in MATLAB R2024a. Make sure you have the required toolboxes:
   - Deep Learning Toolbox
   - (Optionally) Parallel Computing Toolbox if you want to run on a GPU


## Acknowledgments

We gratefully acknowledge the following foundational work, which informed our implementation. The BibTeX entry below cites the referenced paper:

**U-Net: Convolutional Networks for Biomedical Image Segmentation**

```
@inproceedings{ronneberger2015u,
  title={U-net: Convolutional networks for biomedical image segmentation},
  author={Ronneberger, Olaf and Fischer, Philipp and Brox, Thomas},
  booktitle={Medical image computing and computer-assisted intervention--MICCAI 2015: 18th international conference, Munich, Germany, October 5-9, 2015, proceedings, part III 18},
  pages={234--241},
  year={2015},
  organization={Springer}
}
```
